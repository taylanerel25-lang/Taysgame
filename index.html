<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>Fishy Flip â€” Phase B (Playable)</title>
  <style>
    :root {
      --sea-top: #7ad3ff;
      --sea-mid: #2aa8df;
      --sea-deep: #0e6fae;
      --coral-1: #ff7f6e;
      --coral-2: #ffb86b;
      --coral-3: #ffdc6b;
      --ui: #fff;
      --shadow: rgba(0, 0, 0, 0.25);
      --world-w: 360;
      --world-h: 640;
    }* {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
}

body {
  margin: 0;
  background: radial-gradient(120% 120% at 50% 0%, var(--sea-top) 0%, var(--sea-mid) 40%, var(--sea-deep) 100%);
  font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji';
  color: var(--ui);
  display: grid;
  place-items: center;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
  touch-action: none;
}

.frame {
  position: relative;
  width: min(92vw, 48rem);
  aspect-ratio: 9 / 16;
  border-radius: 20px;
  box-shadow: 0 20px 50px var(--shadow);
  overflow: hidden;
  outline: 1px solid rgba(255, 255, 255, 0.08);
  background: linear-gradient(180deg, var(--sea-top), var(--sea-mid) 45%, var(--sea-deep));
}

.fish {
  position: absolute;
  left: 22%;
  top: 45%;
  width: 32px;
  height: 24px;
  transform: translate(-50%, -50%);
  border-radius: 60% 40% 45% 55% / 60% 55% 45% 40%;
  background: linear-gradient(90deg, #ffd9d3 0%, #fff 60%);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.25);
}

.columns {
  position: absolute;
  inset: 0;
  overflow: hidden;
}

.column {
  position: absolute;
  top: 0;
  width: 60px;
  display: grid;
  grid-template-rows: 1fr auto 1fr;
}

.column .top {
  background: var(--coral-1);
  border-bottom-left-radius: 16px;
  border-bottom-right-radius: 16px;
}

.column .gap {
  background: transparent;
}

.column .bottom {
  background: var(--coral-2);
  border-top-left-radius: 16px;
  border-top-right-radius: 16px;
}

.hud {
  position: absolute;
  inset: 0;
  z-index: 3;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding-top: 1rem;
  font-size: 2rem;
  font-weight: 800;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.35);
}

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  backdrop-filter: blur(6px);
  display: grid;
  place-items: center;
  z-index: 5;
}

.panel {
  background: rgba(255, 255, 255, 0.12);
  border-radius: 16px;
  padding: 1.5rem;
  text-align: center;
  color: #fff;
  max-width: 26rem;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.35);
}

.btn {
  appearance: none;
  border: 0;
  border-radius: 12px;
  padding: 0.75rem 1rem;
  font-weight: 700;
  cursor: pointer;
  color: #08324f;
  background: #fff;
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.25);
  margin: 0.5rem;
}

  </style>
</head>
<body>
  <div class="frame">
    <div class="columns" id="columns"></div>
    <div class="fish" id="fish"></div>
    <div class="hud"><span id="score">0</span></div><div class="overlay" id="home">
  <div class="panel">
    <h1>Fishy Flip</h1>
    <p>Tap/Click/Space to swim upward. Dodge coral. Pass columns to score.</p>
    <button class="btn" id="playBtn">Play</button>
  </div>
</div>

<div class="overlay" id="gameover" hidden>
  <div class="panel">
    <h2>Game Over</h2>
    <p>Score: <strong id="finalScore">0</strong></p>
    <p>Best: <strong id="bestScore">0</strong></p>
    <button class="btn" id="restartBtn">Restart</button>
  </div>
</div>

  </div>  <script>
    const GRAVITY = 0.5;
    const FLAP = -8;
    const GAP = 150;
    const SPEED = 2.5;

    const fish = document.getElementById('fish');
    const columnsEl = document.getElementById('columns');
    const scoreEl = document.getElementById('score');
    const homeEl = document.getElementById('home');
    const overEl = document.getElementById('gameover');
    const finalEl = document.getElementById('finalScore');
    const bestEl = document.getElementById('bestScore');
    const playBtn = document.getElementById('playBtn');
    const restartBtn = document.getElementById('restartBtn');

    let y = 320, vy = 0, score = 0, best = +localStorage.getItem('fishyBest') || 0, cols = [];

    function start() {
      homeEl.hidden = true;
      overEl.hidden = true;
      y = 320; vy = 0; score = 0; scoreEl.textContent = 0;
      cols = [];
      columnsEl.innerHTML = '';
      for (let i = 0; i < 3; i++) addColumn(400 + i * 200);
      requestAnimationFrame(loop);
    }

    function addColumn(x) {
      const gapY = Math.random() * 300 + 150;
      const c = document.createElement('div');
      c.className = 'column';
      const top = document.createElement('div');
      const gap = document.createElement('div');
      const bot = document.createElement('div');
      top.className = 'top'; gap.className = 'gap'; bot.className = 'bottom';
      c.append(top, gap, bot);
      columnsEl.append(c);
      cols.push({ el: c, x, gapY, passed: false });
      updateColumn(c, x, gapY);
    }

    function updateColumn(el, x, gapY) {
      el.style.left = x + 'px';
      const gapPct = (GAP / 640) * 100;
      const centerPct = (gapY / 640) * 100;
      const topH = Math.max(0, centerPct - gapPct / 2);
      const botH = Math.max(0, 100 - (centerPct + gapPct / 2));
      el.style.gridTemplateRows = `${topH}% ${gapPct}% ${botH}%`;
    }

    function loop() {
      vy += GRAVITY; y += vy;
      fish.style.top = (y / 640) * 100 + '%';

      cols.forEach(c => {
        c.x -= SPEED;
        updateColumn(c.el, c.x, c.gapY);
        if (!c.passed && c.x + 60 < 80) {
          c.passed = true;
          score++;
          scoreEl.textContent = score;
        }
        if (c.x + 60 < 0) {
          c.x = Math.max(...cols.map(k => k.x)) + 200;
          c.gapY = Math.random() * 300 + 150;
          c.passed = false;
        }
      });

      if (hit()) {
        gameOver();
        return;
      }

      if (y > 640 || y < 0) {
        gameOver();
        return;
      }

      requestAnimationFrame(loop);
    }

    function hit() {
      const fishRect = { x1: 80 - 16, x2: 80 + 16, y1: y - 12, y2: y + 12 };
      for (const c of cols) {
        const top = { x1: c.x, x2: c.x + 60, y1: 0, y2: c.gapY - GAP / 2 };
        const bot = { x1: c.x, x2: c.x + 60, y1: c.gapY + GAP / 2, y2: 640 };
        if (overlap(fishRect, top) || overlap(fishRect, bot)) return true;
      }
      return false;
    }

    function overlap(a, b) {
      return !(a.x2 < b.x1 || a.x1 > b.x2 || a.y2 < b.y1 || a.y1 > b.y2);
    }

    function gameOver() {
      overEl.hidden = false;
      finalEl.textContent = score;
      if (score > best) {
        best = score;
        localStorage.setItem('fishyBest', best);
      }
      bestEl.textContent = best;
    }

    function flap() {
      vy = FLAP;
    }

    document.addEventListener('mousedown', flap);
    document.addEventListener('touchstart', flap, { passive: true });
    document.addEventListener('keydown', e => {
      if (e.code === 'Space' || e.code === 'ArrowUp') flap();
    });

    playBtn.onclick = start;
    restartBtn.onclick = start;
  </script></body>
</html>
